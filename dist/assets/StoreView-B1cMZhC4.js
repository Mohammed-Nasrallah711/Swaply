import{d,i as $,y as x,q as C,o as l,w as n,j as v,aU as I,W as j,a0 as N,p as U,g as F,c as p,l as G,a as o,F as w,a4 as V,am as M,ab as O,b as D,t as T}from"./index-BlBeKsLJ.js";import{_ as q}from"./HeaderPage-DlbyCt4A.js";import{G as z,r as A,a as E}from"./GenericDataTable-DdiJ_m3T.js";import{_ as L}from"./MainDialog-BH8k8M0B.js";import{_ as W}from"./SelectListBox-C5TQ5uG5.js";import"./listbox-C2KpOBbF.js";const H={__name:"ChangeStoreStatus",props:{modelValue:{type:Boolean,default:!1},store:{type:Object,default:()=>({})},storeStatus:{type:String,default:""}},emits:["update:modelValue","update:storeStatus","fetchStores"],setup(S,{emit:h}){const s=S,i=h,b=[{id:1,name:"معلق",val:"pending"},{id:2,name:"نشط",val:"active"},{id:3,name:"غير نشط",val:"inactive"}],r=d(!1),_=$("emitter"),{cleanId:u}=N(),y=x({get:()=>s.modelValue,set:a=>i("update:modelValue",a)}),c=()=>i("update:modelValue",!1),m=x(()=>r.value?"تعديل...":"تعديل"),g=x({get:()=>b.find(a=>a.val===s.storeStatus)||null,set:a=>i("update:storeStatus",a?.val||"")}),k=async()=>{try{r.value=!0,(await j.put(`/admin/stores/${u(s.store.id)}`,{status:g.value.val})).status==200&&(_.emit("showNotificationAlert",["success",`تم تحديث حالة المتجر ${s.store?.name} بنجاح!`]),i("fetchStores")),c()}catch{}finally{r.value=!1}},f=()=>k();return(a,e)=>(l(),C(L,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),"button-label":m.value,onSubmitData:f,loading:r.value},{title:n(()=>[...e[2]||(e[2]=[I(" تعديل بيانات المتجر ",-1)])]),content:n(()=>[v(W,{label:"اختر حالة المتجر",modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=t=>g.value=t),options:b,class:"w-full"},null,8,["modelValue"])]),_:1},8,["modelValue","button-label","loading"]))}},J={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 transition-colors duration-200"},K={class:"space-y-4"},P={class:"grid grid-cols-8 gap-4 pb-4 border-b border-gray-200 dark:border-gray-700"},Q=["src","onClick"],R={class:"flex gap-2 justify-center"},X=["onClick"],Y=["src"],re={__name:"StoreView",setup(S){const h=[{text:"صورة",value:"image",sortable:!1},{text:"رقم المتجر",value:"id",sortable:!0},{text:"اسم المتجر",value:"name",sortable:!0},{text:"رقم الهاتف",value:"phone",sortable:!0},{text:"الموقع",value:"location",sortable:!1},{text:"العنوان",value:"address",sortable:!1},{text:"الحالة",value:"status",sortable:!0},{text:"إجراءات",value:"actions"}],s=U({is_open:!1,data:{}}),i=a=>{s.is_open=!0,s.data=a},b=a=>{switch(a){case"active":return"نشط";case"inactive":return"غير نشط";case"pending":return"معلق";default:return"غير معروف"}},r=d([]),_=d([]),u=d(!0),{formatDate:y}=N();$("emitter");const c=d(!1),m=d(null),g=a=>{m.value=a,c.value=!0},k=()=>{c.value=!1,m.value=null},f=async()=>{u.value=!0;try{const a=await j.get("/admin/stores");_.value=a.data.data,r.value=a.data.data.map(e=>({id:e.id,name:e.name,phone:e.user.phone?`⁦${e.user.phone}⁩`:"غير مسجل",location:e.city?.name??"غير محدد",address:e.address??"غير محدد",image:e.image,status:b(e.status),created_at:y(e.created_at)}))}catch{}finally{u.value=!1}};return F(async()=>{await f()}),(a,e)=>(l(),p(w,null,[v(q,{title:"المتاجر","is-has-add-button":!1}),u.value?(l(),p("div",J,[o("div",K,[o("div",P,[(l(),p(w,null,V(8,t=>o("div",{key:t,class:"h-5 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"})),64))]),(l(),p(w,null,V(8,t=>o("div",{key:t,class:"grid grid-cols-8 gap-4 py-4 border-b border-gray-200 dark:border-gray-700"},[...e[2]||(e[2]=[O('<div class="h-16 w-16 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="h-4 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="h-4 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="h-4 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="h-4 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="h-4 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="h-4 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div><div class="flex gap-2 justify-center"><div class="h-8 w-20 bg-gray-300 dark:bg-gray-700 rounded animate-pulse"></div></div>',8)])])),64))])])):(l(),C(z,{key:1,headers:h,items:r.value},{id:n(({item:t})=>[o("span",null,"# "+T(t.id),1)]),image:n(({item:t})=>[o("img",{src:t.image,alt:"store image",class:"min-w-16 max-w-20 h-16 object-cover rounded cursor-pointer",onClick:B=>g(t.image)},null,8,Q)]),actions:n(t=>[o("div",R,[o("button",{onClick:B=>i(t.item),class:"font-medium bg-yellow-400 text-gray-700 px-3 py-1 rounded"}," تغيير الحالة ",8,X)])]),"prev-icon":n(()=>[v(D(E),{class:"w-5"})]),"next-icon":n(()=>[v(D(A),{class:"w-5"})]),_:1},8,["items"])),c.value?(l(),p("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",onClick:M(k,["self"])},[o("img",{src:m.value,class:"max-w-4xl max-h-[90vh] rounded shadow-lg"},null,8,Y)])):G("",!0),v(H,{modelValue:s.is_open,"onUpdate:modelValue":e[0]||(e[0]=t=>s.is_open=t),store:s.data,"store-status":s.status,"onUpdate:storeStatus":e[1]||(e[1]=t=>s.status=t),onFetchStores:f},null,8,["modelValue","store","store-status"])],64))}};export{re as default};
