import{_ as T}from"./HeaderTitle-DK1zGWEz.js";import{_ as D,r as W}from"./BaseSwitch-CnzZBtgG.js";import{c as l,o as s,a as e,i as L,y as R,M as q,W as B,q as y,ac as P,ad as z,t as m,j as c,m as H,s as S,p as F,ae as O,af as Z,F as $,a4 as A,l as k,b as d,a0 as G,n as v,k as J,L as M,d as b,f as U,g as N,ag as K,w as h,ah as Q,ai as X,aj as Y,ak as tt,a1 as et,a6 as at,al as st,T as it,H as ot}from"./index-BlBeKsLJ.js";import{j as nt,r as rt,a as lt,A as dt,F as ct,I as ut}from"./listbox-C2KpOBbF.js";import{_ as pt}from"./LogoSection.vue_vue_type_script_setup_true_lang-Dg6w-Ry2.js";function gt(a,i){return s(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M1.72 5.47a.75.75 0 0 1 1.06 0L9 11.69l3.756-3.756a.75.75 0 0 1 .985-.066 12.698 12.698 0 0 1 4.575 6.832l.308 1.149 2.277-3.943a.75.75 0 1 1 1.299.75l-3.182 5.51a.75.75 0 0 1-1.025.275l-5.511-3.181a.75.75 0 0 1 .75-1.3l3.943 2.277-.308-1.149a11.194 11.194 0 0 0-3.528-5.617l-3.809 3.81a.75.75 0 0 1-1.06 0L1.72 6.53a.75.75 0 0 1 0-1.061Z","clip-rule":"evenodd"})])}function mt(a,i){return s(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"})])}const xt={class:"flex bg-white dark:bg-gray-900 shadow-md dark:shadow-[inset_0_-4px_10px_rgba(0,0,0,0.01)] dark:shadow-slate-700 w-full items-center rounded-2xl justify-between px-8 py-4 mb-4 transition-colors"},ft={class:"flex items-center gap-4"},yt={class:"icon"},ht={class:"text-blue-600 dark:text-white font-medium text-[16px] mb-1 block"},vt={class:"text-gray-600 dark:text-gray-300 font-normal text-[14px] mb-2 block"},_t={class:"action"},bt={__name:"SingleNotification",props:{icon:[Object,String,Function],title:String,description:String,isEnable:Boolean,from:String,id:String},emits:["update:isEnable"],setup(a,{emit:i}){const o=a,u=i,p=L("emitter"),n=R({get:()=>o.isEnable,set:t=>u("update:isEnable",t)});return q(()=>n.value,async t=>{(await B.put("/notifications/change-status-methods",{notification_method:o.id,status:t})).status==200&&p.emit("showNotificationAlert",["success",`تم ${t?"تفعيل":"ايقاف"} ${o.title} بنجاح`])}),(t,x)=>(s(),l("div",xt,[e("div",ft,[e("div",yt,[a.from=="mdi"?(s(),y(P,{key:0,icon:a.icon,class:"w-[30px] h-[30px] text-blue-800 dark:text-white"},null,8,["icon"])):(s(),y(z(a.icon),{key:1,class:"w-[30px] h-[30px] text-blue-800 dark:text-white dark:fill-white"}))]),e("div",null,[e("div",null,[e("span",ht,m(a.title),1),e("span",vt,m(a.description),1)])])]),e("div",_t,[c(D,{"model-value":n.value,"onUpdate:modelValue":x[0]||(x[0]=f=>n.value=f)},null,8,["model-value"])])]))}},wt={class:"w-full"},kt={__name:"NotificationSetting",setup(a){const i=H(),{user:o}=S(i),u=F([{id:"sms",icon:mt,from:"heroicons",title:"إشعارات الرسائل النصية",description:"تلقي التنبيهات عبر الرسائل القصيرة SMS",isEnable:o.value?.notification_methods?.sms},{id:"email",icon:O,from:"mdi",title:"إشعارات البريد الالكتروني",description:"تلقي التنبيهات عبر رسائل البريد",isEnable:o.value?.notification_methods?.email},{id:"whatsapp",icon:Z,from:"mdi",title:"إشعارات الواتساب (WhatsApp)",description:"تلقي التنبيهات عبر رسائل الواتساب WhatsApp",isEnable:o.value?.notification_methods?.whatsapp}]);return(p,n)=>(s(),l("div",wt,[(s(!0),l($,null,A(u,t=>(s(),y(bt,{key:t.id,title:t.title,description:t.description,icon:t.icon,from:t.from,id:t.id,"is-enable":t.isEnable,"onUpdate:isEnable":x=>t.isEnable=x},null,8,["title","description","icon","from","id","is-enable","onUpdate:isEnable"]))),128))]))}},$t={class:"flex justify-between items-center"},St={class:"text-gray-800 dark:text-gray-200 font-normal"},At={key:0,class:"bg-red-600 dark:bg-red-500 text-white inline-block px-4 py-1 rounded-md text-[12px] font-medium cursor-default"},Nt={class:"flex items-center gap-1"},Ut={class:"time text-[12px] font-normal text-gray-600 dark:text-gray-300"},Vt={__name:"LastNotificationBox",props:{title:String,time:String,isDecrease:{type:Boolean,default:!1},isIncrease:{type:Boolean,default:!1},isUrgent:{type:Boolean,default:!1}},setup(a){const{getRelativeTime:i}=G();return(o,u)=>(s(),l("div",{class:v(["px-6 py-[10px] rounded-[10px] mb-4",{"bg-sky-100 dark:bg-sky-900":!a.isUrgent,"bg-red-100 dark:bg-red-800 border-red-400 dark:border-red-600 border":a.isUrgent}])},[e("div",$t,[e("span",St,m(a.title),1),a.isUrgent?(s(),l("span",At," عاجل ")):k("",!0)]),e("div",Nt,[e("p",Ut,m(d(i)(a.time).replace("قبل","منذ")),1),e("span",null,[a.isIncrease?(s(),y(d(J),{key:0,class:v(["w-5 h-5",{"text-green-500":!a.isUrgent,"text-red-500":a.isUrgent}])},null,8,["class"])):k("",!0),a.isDecrease?(s(),y(d(gt),{key:1,class:v(["w-5 h-5",{"text-green-500":!a.isUrgent,"text-red-500":a.isUrgent}])},null,8,["class"])):k("",!0)])])],2))}},Ct={class:"font-medium text-blue-600 text-[20px]"},E={__name:"NotificationSectionTitle",props:{title:{type:String,required:!0}},setup(a){return(i,o)=>(s(),l("h4",Ct,m(a.title),1))}},jt={class:"flex items-center justify-between mb-6"},Bt={key:1,class:"flex justify-center items-center h-[50%] text-sm font-normal text-gray-800 dark:text-gray-200"},Et={__name:"LastNotification",setup(a){const i=b(!1),o=U(),{lastNotifications:u}=S(o);return N(async()=>{await o.fetchLastNotifications()}),(p,n)=>d(u).data?(s(),l("div",{key:0,class:v(["px-6 pt-8 h-[330px] pb-2 rounded-[20px] dark:shadow-[inset_0_4px_10px_rgba(0,0,0,0.01)] dark:shadow-slate-700 bg-white dark:bg-gray-900",{"overflow-y-auto":i.value,"overflow-y-hidden":!i.value}])},[e("div",jt,[c(E,{title:"الإشعارات الاخيرة"}),d(u).data.length>2?(s(),l("button",{key:0,onClick:n[0]||(n[0]=t=>i.value=!i.value),class:"show-more text-gray-600 dark:text-gray-300 border border-gray-400 dark:border-gray-600 rounded-lg text-[12px] w-[94px] h-8 font-medium bg-gray-100 dark:bg-gray-700 transition-all hover:bg-gray-200 dark:hover:bg-gray-600"},m(i.value?"عرض أقل":"عرض الكل"),1)):k("",!0)]),d(u).data.length>0?(s(!0),l($,{key:0},A(d(u).data,t=>(s(),y(Vt,{key:t.id,title:t.data.title,time:t.created_at,"is-decrease":t.data.status=="lt","is-increase":t.data.status=="gt","is-urgent":t.isUrgent},null,8,["title","time","is-decrease","is-increase","is-urgent"]))),128)):(s(),l("p",Bt," لا يوجد اي إشعارات حتى الان "))],2)):k("",!0)}},It=M(Et,[["__scopeId","data-v-d12636e1"]]),Lt={class:"flex"},Rt={class:"title text-gray-900 dark:text-white font-medium text-[16px] mb-1 block"},Ft={class:"status flex items-center gap-2 mr-2"},Mt={key:2,class:"alerted bg-red-600 rounded-2xl font-medium text-[12px] text-white py-1 px-2.5 cursor-default select-none"},Tt={class:"text-gray-600 dark:text-gray-300 font-normal text-[14px] block"},Dt={__name:"ActiveNotificationBox",props:{id:Number,title:{type:String},whenRun:String,isActive:String,alerted:Boolean},emits:["update:isActive"],setup(a,{emit:i}){const o=a,u=b(null),p=L("emitter"),n=i,t=b(!0);N(()=>{setTimeout(()=>{t.value=!1},50)});const x=async()=>{const _=o.isActive=="active"?"inactive":"active";(await B.put(`notifications/${o.id}`,{status:_})).status==200&&(n("update:isActive",_),p.emit("showNotificationAlert",["success",`تم ${_=="active"?"تنشيط":"إيقاف"} التنبيه
  بنجاح`]))},f=b(!1),w=async()=>{f.value=!0,(await B.delete(`/notifications/${o.id}`)).status==200?(p.emit("showNotificationAlert",["success","تم حذف التنبيه بنجاح!"]),setTimeout(()=>{u.value.remove()},300)):f.value=!1};return(_,V)=>(s(),l("div",{class:v(["flex justify-between items-center bg-gray-100 dark:bg-gray-700 mb-3 rounded-[16px] p-3 pl-8 pr-4 transition-all duration-300 ease-out",{"opacity-0 scale-95 -translate-y-2":t.value,"opacity-0 scale-95 translate-y-2":f.value}]),ref_key:"box",ref:u},[e("div",null,[e("div",Lt,[e("span",Rt,m(a.title),1),e("span",Ft,[a.isActive=="active"?(s(),l("span",{key:0,class:"active bg-green-700 dark:bg-green-600 rounded-2xl font-medium text-[12px] text-white py-1 px-[18px] cursor-pointer transition-opacity hover:opacity-70",onClick:x}," نشط ")):(s(),l("span",{key:1,class:"in-active bg-gray-200 dark:bg-gray-600 rounded-2xl font-medium text-[12px] text-black dark:text-white py-1 px-[18px] cursor-pointer transition-opacity hover:opacity-70",onClick:x}," متوقف ")),a.alerted?(s(),l("span",Mt," تم التنبيه ")):k("",!0)])]),e("span",Tt,m(a.whenRun),1)]),c(d(W),{class:"w-6 h-6 text-gray-600 dark:text-gray-300 transition-all cursor-pointer hover:text-gray-900 dark:hover:text-white",onClick:w})],2))}},Wt={class:"px-6 pt-8 pb-6 rounded-[20px] overflow-y-auto shadow-md dark:shadow-[inset_0_4px_10px_rgba(0,0,0,0.01)] dark:shadow-slate-700 shadow-slate-200 h-full max-h-[644px] bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"},qt={key:1,class:"flex justify-center items-center h-[90%] text-sm font-normal text-gray-800 dark:text-gray-200"},Pt={__name:"ActiveNotification",setup(a){const i=U(),{notifications:o}=S(i);return N(async()=>{await i.fetchNotification()}),(u,p)=>(s(),l("div",Wt,[c(E,{title:"التنبيهات النشطة",class:"mb-6"}),d(o).length?(s(!0),l($,{key:0},A(d(o),n=>(s(),y(Dt,{key:n.title,id:n.id,title:n.product?.name,"is-active":n.status,"onUpdate:isActive":t=>n.status=t,whenRun:n.type==="lt"?`أقل من ${+n.target_price}`:`أكبر من ${+n.target_price}`,alerted:!!n.is_triggered},null,8,["id","title","is-active","onUpdate:isActive","whenRun","alerted"]))),128)):(s(),l("p",qt," لم تقم حتى الآن بإضافة أي تنبيه "))]))}},zt=M(Pt,[["__scopeId","data-v-ddb41653"]]),Ht={class:"px-6 pt-8 pb-6 rounded-[20px] shadow-md dark:shadow-[inset_0_4px_10px_rgba(0,0,0,0.01)] dark:shadow-slate-700 bg-white dark:bg-gray-900 mt-6"},Ot={class:"combobox mt-6"},Zt={class:"relative mt-1"},Gt={class:"flex my-4 gap-4"},Jt={class:"relative w-60"},Kt={class:"relative w-full"},Qt={__name:"AddNotification",setup(a){const i=K(),{products:o}=S(i),u=U(),{loading:p,status:n}=S(u),t=F({price:"",selected:{id:2,name:"أقل من",value:"lt"}}),x=[{id:1,name:"أكبر من",value:"gt"},{id:2,name:"أقل من",value:"lt"}],f=b(null),w=b(""),_=R(()=>w.value===""?o.value:o.value.filter(I=>I.name.toLowerCase().includes(w.value.toLowerCase()))),V=async()=>{await u.addNotification(f.value.id,t.selected.value,t.price),(n.value=201)&&(w.value="",f.value="",t.price="",t.selected={id:2,name:"أقل من",value:"lt"},n.value=400)};return N(async()=>{await i.fetchAllProductsIds()}),(I,g)=>(s(),l("div",Ht,[c(E,{title:"اضافة تنبيه جديد"}),e("div",Ot,[c(d(tt),{modelValue:f.value,"onUpdate:modelValue":g[1]||(g[1]=r=>f.value=r)},{default:h(()=>[e("div",Zt,[c(d(Q),{class:"focus:border-gray-500 border-none py-3 text-gray-900 dark:text-white focus:ring-gray-500 rounded-md bg-gray-100 dark:bg-gray-700 block w-full placeholder:text-[14px] placeholder:font-normal dark:placeholder-gray-400",onChange:g[0]||(g[0]=r=>w.value=r.target.value),placeholder:"اسم المنتج (مثل: بيض, رز, حليب)",displayValue:r=>r?.name},null,8,["displayValue"]),c(d(X),{class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-gray-800 shadow-lg"},{default:h(()=>[(s(!0),l($,null,A(_.value,r=>(s(),y(d(Y),{key:r.id,value:r},{default:h(({active:C,selected:j})=>[e("li",{class:v(["cursor-pointer select-none py-2 px-3",[C?"bg-gray-500 dark:bg-gray-600 text-white":"text-gray-900 dark:text-gray-200",j?"bg-gray-200 dark:bg-blue-700 text-gray-600":""]])},m(r.name),3)]),_:2},1032,["value"]))),128))]),_:1})])]),_:1},8,["modelValue"])]),e("div",Gt,[c(d(ut),{modelValue:t.selected,"onUpdate:modelValue":g[2]||(g[2]=r=>t.selected=r)},{default:h(()=>[e("div",Jt,[c(d(nt),{class:"w-full flex items-center justify-between rounded-md bg-gray-100 dark:bg-gray-700 py-3 px-3 text-gray-900 dark:text-white"},{default:h(({open:r})=>[e("span",null,m(t.selected.name),1),r?(s(),y(d(rt),{key:0,class:"w-5 h-5 text-gray-500 mt-2"})):(s(),y(d(lt),{key:1,class:"w-5 h-5 text-gray-500 mt-2"}))]),_:1}),c(d(dt),{class:"absolute mt-1 max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-gray-800 shadow-lg"},{default:h(()=>[(s(),l($,null,A(x,r=>c(d(ct),{key:r.id,value:r},{default:h(({active:C,selected:j})=>[e("li",{class:v(["cursor-pointer select-none py-2 px-3",[C?"bg-gray-500 dark:bg-gray-600 text-white":"text-gray-900 dark:text-gray-200",j?"bg-gray-200 dark:bg-blue-700 text-gray-600":""]])},m(r.name),3)]),_:2},1032,["value"])),64))]),_:1})])]),_:1},8,["modelValue"]),e("div",Kt,[e("span",{class:v(["absolute inset-y-0 right-4 flex items-center pl-3 -mt-1 text-gray-500 dark:text-gray-300 text-[24px] font-normal",t.price?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"])}," ₪ ",2),et(e("input",{type:"number",min:"0","onUpdate:modelValue":g[3]||(g[3]=r=>t.price=r),onInput:g[4]||(g[4]=r=>{r.target.value<0&&(r.target.value=0),t.price=r.target.value}),class:"no-spinner focus:border-gray-500 border-none py-3 pl-8 pr-9 flex-1 text-gray-900 dark:text-white focus:ring-gray-500 rounded-md bg-gray-100 dark:bg-gray-700 block w-full placeholder:text-[14px] placeholder:font-normal dark:placeholder-gray-400",placeholder:"0"},null,544),[[at,t.price]])])]),c(it,{label:"اضافة تنبيه",onClick:g[5]||(g[5]=r=>V()),class:v({"pointer-events-none":d(p)})},{icon:h(()=>[c(d(st),{class:"w-6 h-6"})]),_:1},8,["class"])]))}},Xt={class:"flex gap-8 mt-12 flex-col lg:flex-row"},Yt={class:"flex-1"},te={class:"notification-setting w-full"},ee={class:"right-site flex-1 relative"},ae={class:"pb-4"},le={__name:"NotificationsView",setup(a){const i=b(!1),o=U();return N(async()=>{await o.markAsRead()}),(u,p)=>(s(),l($,null,[c(ot,null,{default:h(()=>[c(pt)]),_:1}),c(T,{title:"مركز التنبيهات",subtitle:"تتبع تغييرات الاسعار و احصل على إشعارات فورية"}),e("div",Xt,[e("div",Yt,[e("div",te,[c(kt),c(It,{modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=n=>i.value=n)},null,8,["modelValue"])])]),e("div",ee,[c(zt,{showScroll:i.value},null,8,["showScroll"]),p[1]||(p[1]=e("span",{class:"absolute w-full left-0 bottom-0 h-8 rounded-bl-[20px] rounded-br-[20px] bg-gradient-to-t from-white to-transparent dark:from-gray-900"},null,-1))])]),e("div",ae,[c(Qt)])],64))}};export{le as default};
